name: Autograding Tests
'on':
  - workflow_dispatch
  - repository_dispatch
permissions:
  checks: write
  actions: read
  contents: read
jobs:
  run-autograding-tests:
    runs-on: ubuntu-latest
    if: github.actor != 'github-classroom[bot]'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Run grading
        id: grading
        run: |
          FINAL_SCORE=$(cat pcb_score.txt | tr -dc '0-9')
          echo "points=$FINAL_SCORE" >> "$GITHUB_OUTPUT"
          echo "total-points=100" >> "$GITHUB_OUTPUT"
      
      - uses: markpatterson27/autograding@dev-points-input-release
        with:
          points: "${{ steps.grading.outputs.points }}"
          available-points: "${{ steps.grading.outputs.total-points }}"

